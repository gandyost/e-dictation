<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Dictation Web App</title>
    
    <!-- Meta tags for SEO and PWA -->
    <meta name="description" content="ì˜ì–´ ë°›ì•„ì“°ê¸° í•™ìŠµ í”Œë«í¼ - ìŒì„±ìœ¼ë¡œ ë“£ê³  ì •í™•íˆ ì…ë ¥í•˜ëŠ” ì˜ì–´ í•™ìŠµ ë„êµ¬">
    <meta name="keywords" content="ì˜ì–´, ë°›ì•„ì“°ê¸°, í•™ìŠµ, êµìœ¡, ìŒì„±ì¸ì‹, dictation">    <meta name="author" content="English Dictation Team">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="shortcut icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
      <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
      <!-- Firebase Configuration - Firebase SDK ë°”ë¡œ ë‹¤ìŒì— ë¡œë“œ -->
    <script src="js/firebase-config.js?v=4"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- í—¤ë” -->
    <header class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <div class="flex items-center">
                    <h1 class="text-3xl font-bold text-gray-900">
                        ğŸ“ English Dictation
                    </h1>
                </div>
                <div class="text-sm text-gray-500">
                    ì˜ì–´ ë°›ì•„ì“°ê¸° í•™ìŠµ í”Œë«í¼
                </div>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold text-gray-900 mb-4">
                í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‘‹
            </h2>
            <p class="text-xl text-gray-600 mb-8">
                ìŒì„±ìœ¼ë¡œ ë“£ê³  ì •í™•íˆ ì…ë ¥í•˜ëŠ” ì˜ì–´ ë°›ì•„ì“°ê¸° í•™ìŠµì„ ì‹œì‘í•´ë³´ì„¸ìš”
            </p>
        </div>

        <!-- ì„ íƒ ì¹´ë“œ -->
        <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <!-- êµì‚¬ ì¹´ë“œ -->
            <div class="bg-white rounded-xl shadow-lg p-8 hover:shadow-xl transition-shadow duration-300 border-2 border-transparent hover:border-blue-200">
                <div class="text-center">
                    <div class="mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-6">
                        <span class="text-2xl">ğŸ‘©â€ğŸ«</span>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">êµì‚¬</h3>
                    <p class="text-gray-600 mb-6">
                        í…ŒìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ê³  í•™ìƒë“¤ì˜ ì§„í–‰ ìƒí™©ì„ ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”
                    </p>
                    <ul class="text-sm text-gray-500 mb-6 text-left space-y-2">
                        <li>âœ… ë°›ì•„ì“°ê¸° í…ŒìŠ¤íŠ¸ ìƒì„±</li>
                        <li>âœ… ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§</li>
                        <li>âœ… í•™ìƒ ê²°ê³¼ ë¶„ì„ ë° í†µê³„</li>
                        <li>âœ… í…ŒìŠ¤íŠ¸ ì½”ë“œ ê´€ë¦¬</li>
                    </ul>
                    <button 
                        onclick="showTeacherLogin()"
                        class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors duration-300"
                    >
                        êµì‚¬ ë¡œê·¸ì¸
                    </button>
                </div>
            </div>

            <!-- í•™ìƒ ì¹´ë“œ -->
            <div class="bg-white rounded-xl shadow-lg p-8 hover:shadow-xl transition-shadow duration-300 border-2 border-transparent hover:border-green-200">
                <div class="text-center">
                    <div class="mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-6">
                        <span class="text-2xl">ğŸ“</span>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">í•™ìƒ</h3>
                    <p class="text-gray-600 mb-6">
                        í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì…ë ¥í•˜ê³  ë°›ì•„ì“°ê¸° í…ŒìŠ¤íŠ¸ì— ì°¸ì—¬í•˜ì„¸ìš”
                    </p>
                    <ul class="text-sm text-gray-500 mb-6 text-left space-y-2">
                        <li>âœ… í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ê°„í¸ ì ‘ì†</li>
                        <li>âœ… ìŒì„± ë“£ê³  ë°›ì•„ì“°ê¸°</li>
                        <li>âœ… ì‹¤ì‹œê°„ ìë™ ì±„ì </li>
                        <li>âœ… ê°œì¸ ê²°ê³¼ í™•ì¸</li>
                    </ul>
                    <button 
                        onclick="showStudentJoin()"
                        class="w-full bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors duration-300"
                    >
                        í…ŒìŠ¤íŠ¸ ì°¸ì—¬
                    </button>
                </div>
            </div>
        </div>

        <!-- íŠ¹ì§• ì„¹ì…˜ -->
        <div class="mt-16 text-center">
            <h3 class="text-2xl font-bold text-gray-900 mb-8">ì£¼ìš” íŠ¹ì§•</h3>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-white rounded-lg p-6 shadow-md">
                    <div class="text-3xl mb-4">ğŸ¯</div>
                    <h4 class="font-semibold text-gray-900 mb-2">ì •í™•í•œ ì±„ì </h4>
                    <p class="text-gray-600 text-sm">AI ê¸°ë°˜ ìë™ ì±„ì ìœ¼ë¡œ ì •í™•í•˜ê³  ë¹ ë¥¸ ê²°ê³¼ ì œê³µ</p>
                </div>
                <div class="bg-white rounded-lg p-6 shadow-md">
                    <div class="text-3xl mb-4">ğŸ“Š</div>
                    <h4 class="font-semibold text-gray-900 mb-2">ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</h4>
                    <p class="text-gray-600 text-sm">í•™ìƒë“¤ì˜ ì§„í–‰ ìƒí™©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸</p>
                </div>
                <div class="bg-white rounded-lg p-6 shadow-md">
                    <div class="text-3xl mb-4">ğŸ“±</div>
                    <h4 class="font-semibold text-gray-900 mb-2">ëª¨ë“  ê¸°ê¸° ì§€ì›</h4>
                    <p class="text-gray-600 text-sm">PC, íƒœë¸”ë¦¿, ìŠ¤ë§ˆíŠ¸í°ì—ì„œ ììœ ë¡­ê²Œ ì‚¬ìš©</p>
                </div>
            </div>
        </div>
    </main>

    <!-- êµì‚¬ ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div id="teacherModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-gray-900 mb-2">êµì‚¬ ë¡œê·¸ì¸</h3>
                <p class="text-gray-600">ê³„ì •ì— ë¡œê·¸ì¸í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ê´€ë¦¬í•˜ì„¸ìš”</p>
            </div>
            
            <form id="teacherLoginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ì´ë©”ì¼</label>
                    <input 
                        type="email" 
                        id="teacherEmail"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="teacher@example.com"
                        required
                    >
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ë¹„ë°€ë²ˆí˜¸</label>
                    <input 
                        type="password" 
                        id="teacherPassword"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                        required
                    >
                </div>
                <div class="flex space-x-3">
                    <button 
                        type="submit"
                        class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors"
                    >
                        ë¡œê·¸ì¸
                    </button>
                    <button 
                        type="button"
                        onclick="showTeacherSignup()"
                        class="flex-1 bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors"
                    >
                        íšŒì›ê°€ì…
                    </button>
                </div>
            </form>
            
            <button 
                onclick="hideTeacherModal()"
                class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
            >
                âœ•
            </button>
        </div>
    </div>

    <!-- í•™ìƒ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì…ë ¥ ëª¨ë‹¬ -->
    <div id="studentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-gray-900 mb-2">í…ŒìŠ¤íŠ¸ ì°¸ì—¬</h3>
                <p class="text-gray-600">êµì‚¬ê°€ ì œê³µí•œ 6ìë¦¬ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            </div>
            
            <form id="studentJoinForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">í…ŒìŠ¤íŠ¸ ì½”ë“œ</label>
                    <input 
                        type="text" 
                        id="testCode"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-center text-lg font-mono uppercase"
                        placeholder="ABC123"
                        maxlength="6"
                        pattern="[A-Z0-9]{6}"
                        required
                    >
                    <p class="text-xs text-gray-500 mt-1">ì˜ˆ: ABC123 (ëŒ€ë¬¸ìì™€ ìˆ«ì 6ìë¦¬)</p>
                </div>
                <button 
                    type="submit"
                    class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors"
                >
                    í…ŒìŠ¤íŠ¸ ì…ì¥
                </button>
            </form>
            
            <button 
                onclick="hideStudentModal()"
                class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
            >
                âœ•
            </button>
        </div>
    </div>

    <!-- ë¡œë”© ìŠ¤í”¼ë„ˆ -->
    <div id="loadingSpinner" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 flex items-center space-x-3">
            <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
            <span>ì²˜ë¦¬ ì¤‘...</span>
        </div>
    </div>    <!-- JavaScript íŒŒì¼ë“¤ -->
    <script src="js/test-code.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="js/performance.js"></script>
    
    <script>
        // í˜ì´ì§€ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            checkPerformance();
        });

        // ì•± ì´ˆê¸°í™”
        async function initializeApp() {
            try {
                // Service Worker ë“±ë¡ (HTTPS ë˜ëŠ” localhostì—ì„œë§Œ)
                if ('serviceWorker' in navigator && (location.protocol === 'https:' || location.hostname === 'localhost' || location.hostname === '127.0.0.1')) {
                    try {
                        const registration = await navigator.serviceWorker.register('/sw.js');
                        console.log('Service Worker ë“±ë¡ ì„±ê³µ:', registration);
                    } catch (swError) {
                        console.warn('Service Worker ë“±ë¡ ì‹¤íŒ¨ (ë¬´ì‹œë¨):', swError.message);
                    }
                } else {
                    console.log('Service WorkerëŠ” HTTPS ë˜ëŠ” localhostì—ì„œë§Œ ì§€ì›ë©ë‹ˆë‹¤.');
                }

                // Firebase ì´ˆê¸°í™” í™•ì¸
                if (typeof firebase !== 'undefined') {
                    console.log('Firebase ì´ˆê¸°í™” ì™„ë£Œ');
                }

                // ì ‘ê·¼ì„± í–¥ìƒ
                if (typeof AccessibilityManager !== 'undefined') {
                    window.accessibilityManager = new AccessibilityManager();
                }

                // ì„±ëŠ¥ ìµœì í™”
                if (typeof PerformanceOptimizer !== 'undefined') {
                    window.performanceOptimizer = new PerformanceOptimizer();
                }

            } catch (error) {
                console.error('ì•± ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
            }
        }        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            // ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ìƒíƒœ
            window.addEventListener('online', handleOnlineStatus);
            window.addEventListener('offline', handleOfflineStatus);
            
            // í‚¤ë³´ë“œ ì ‘ê·¼ì„±
            document.addEventListener('keydown', handleKeyboardNavigation);
        }

        // ì„±ëŠ¥ í™•ì¸
        function checkPerformance() {
            // ëŠë¦° ë„¤íŠ¸ì›Œí¬ ê°ì§€
            if ('connection' in navigator) {
                const connection = navigator.connection;
                if (connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g') {
                    showLowBandwidthNotice();
                }
            }
        }

        // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì²˜ë¦¬        // ì˜¨ë¼ì¸ ìƒíƒœ ì²˜ë¦¬
        function handleOnlineStatus() {
            hideOfflineNotice();
            showNotification('ì¸í„°ë„· ì—°ê²°ì´ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        function handleOfflineStatus() {
            showOfflineNotice();
        }

        function showOfflineNotice() {
            const notice = document.createElement('div');
            notice.id = 'offline-notice';
            notice.className = 'fixed top-0 left-0 right-0 bg-red-600 text-white text-center py-2 z-50';
            notice.innerHTML = '<i class="fas fa-wifi-slash mr-2"></i>ì˜¤í”„ë¼ì¸ ìƒíƒœì…ë‹ˆë‹¤. ì¼ë¶€ ê¸°ëŠ¥ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            document.body.appendChild(notice);
        }

        function hideOfflineNotice() {
            const notice = document.getElementById('offline-notice');
            if (notice) {
                notice.remove();
            }
        }

        function showLowBandwidthNotice() {
            const notice = document.createElement('div');
            notice.className = 'fixed top-16 left-4 right-4 bg-yellow-600 text-white p-3 rounded-lg z-40';
            notice.innerHTML = '<i class="fas fa-signal mr-2"></i>ëŠë¦° ë„¤íŠ¸ì›Œí¬ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì¼ë¶€ ê¸°ëŠ¥ì´ ìµœì í™”ë©ë‹ˆë‹¤.';
            document.body.appendChild(notice);
            
            setTimeout(() => notice.remove(), 5000);
        }

        // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        function handleKeyboardNavigation(e) {
            if (e.key === 'Tab') {
                document.body.classList.add('keyboard-navigation');
            }
        }

        // ì•Œë¦¼ í‘œì‹œ
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showTeacherLogin() {
            document.getElementById('teacherModal').classList.remove('hidden');
            document.getElementById('teacherModal').classList.add('flex');
            
            // ì ‘ê·¼ì„±: ì²« ë²ˆì§¸ ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
            setTimeout(() => {
                const firstInput = document.querySelector('#teacherModal input');
                if (firstInput) firstInput.focus();
            }, 100);
        }

        function hideTeacherModal() {
            document.getElementById('teacherModal').classList.add('hidden');
            document.getElementById('teacherModal').classList.remove('flex');
        }

        function showStudentJoin() {
            document.getElementById('studentModal').classList.remove('hidden');
            document.getElementById('studentModal').classList.add('flex');
            
            // ì ‘ê·¼ì„±: ì²« ë²ˆì§¸ ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
            setTimeout(() => {
                const firstInput = document.querySelector('#studentModal input');
                if (firstInput) firstInput.focus();
            }, 100);
        }

        function hideStudentModal() {
            document.getElementById('studentModal').classList.add('hidden');
            document.getElementById('studentModal').classList.remove('flex');
        }

        function showLoading() {
            document.getElementById('loadingSpinner').classList.remove('hidden');
            document.getElementById('loadingSpinner').classList.add('flex');
        }        function hideLoading() {
            document.getElementById('loadingSpinner').classList.add('hidden');
            document.getElementById('loadingSpinner').classList.remove('flex');
        }        // í…ŒìŠ¤íŠ¸ ì½”ë“œ ì…ë ¥ ìë™ ëŒ€ë¬¸ì ë³€í™˜
        document.getElementById('testCode').addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });

        // ê¸€ë¡œë²Œ ì—ëŸ¬ í•¸ë“¤ëŸ¬
        window.addEventListener('error', function(event) {
            console.error('Global error caught:', event.error);
            
            // ì‚¬ìš©ìì—ê²Œ ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
            if (!document.querySelector('.error-notification')) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-notification fixed top-4 right-4 bg-red-500 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm';
                errorDiv.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        <div>
                            <div class="font-semibold">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</div>
                            <div class="text-sm opacity-90">í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”</div>
                        </div>
                        <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                document.body.appendChild(errorDiv);
                
                // 5ì´ˆ í›„ ìë™ ì œê±°
                setTimeout(() => {
                    if (errorDiv.parentElement) {
                        errorDiv.remove();
                    }
                }, 5000);
            }
        });

        // Promise rejection í•¸ë“¤ëŸ¬
        window.addEventListener('unhandledrejection', function(event) {
            console.error('Unhandled promise rejection:', event.reason);
            event.preventDefault(); // ê¸°ë³¸ ì—ëŸ¬ í‘œì‹œ ë°©ì§€
        });

        // ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
        if ('performance' in window) {
            window.addEventListener('load', function() {
                setTimeout(function() {
                    const perfData = window.performance.timing;
                    const loadTime = perfData.loadEventEnd - perfData.navigationStart;
                    console.log('Page load time:', loadTime + 'ms');
                    
                    // ë¡œë“œ ì‹œê°„ì´ 3ì´ˆ ì´ìƒì´ë©´ ê²½ê³ 
                    if (loadTime > 3000) {
                        console.warn('Slow page load detected:', loadTime + 'ms');
                    }
                }, 0);
            });
        }
    </script>
</body>
</html>
